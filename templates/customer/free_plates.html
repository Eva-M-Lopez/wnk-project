{% extends "base.html" %}

{% block title %}Free Plates - Waste Not Kitchen{% endblock %}

{% block content %}
<div class="dashboard-container">
    <h2>Free Plates (Donated by Community)</h2>
    
    <div class="info-message">
        <p><strong>Daily Limit:</strong> You have claimed <strong>{{ claimed_count }}</strong> out of <strong>{{ max_allowed }}</strong> free plates today.</p>
        {% if claimed_count >= max_allowed %}
            <p class="limit-reached-message">âœ“ You have reached your daily limit. Thank you for using Waste Not Kitchen! Come back tomorrow for more free plates.</p>
        {% endif %}
    </div>
    
    {% if claimed_count >= max_allowed %}
        <!-- Show message only, no plates -->
        <div class="no-data">
            <h3>Daily Limit Reached</h3>
            <p>You cannot claim any more plates today. Please return tomorrow to claim more free donated meals.</p>
            <p>Your claimed plates can be picked up using the codes provided.</p>
        </div>
    {% elif plates %}
        <div class="plates-grid">
            {% for plate in plates %}
            <div class="plate-card">
                <h3>{{ plate.title or 'Food Item' }}</h3>
                <p class="restaurant-name">{{ plate.restaurant_name }}</p>
                <p class="description">{{ plate.description }}</p>
                <p class="price free-badge">FREE (Donated)</p>
                <p class="quantity">Quantity: {{ plate.qty }}</p>
                <p class="time-window">
                    <small>Pickup: {{ plate.start_time.strftime('%m/%d %I:%M%p') }} - {{ plate.end_time.strftime('%I:%M%p') }}</small>
                </p>
                
                <form method="POST" action="{{ url_for('customer.claim_free', reservation_id=plate.reservation_id) }}" class="reserve-form">
                    <button type="submit" class="btn btn-primary">Claim Free Plate</button>
                </form>
            </div>
            {% endfor %}
        </div>
    {% else %}
        <p class="no-data">No free plates available at the moment. Check back later when donors contribute!</p>
    {% endif %}
</div>
{% endblock %}